---
collection_products:
  limit: {{ multiply section.settings.col section.settings.row}}
---

{{ assign 'prefix' 'stage-featured-collection'}}

{{ assign 'productList' (get 'list' (get section.settings.product_categories collection_products))}}
{{#if (boolean (isTruthy section.settings.product_categories) '&&' (boolean (length productList) '!=' 0 ))}}
  {{ assign 'categoryDetail' (get section.settings.product_categories all_collections)}}
  {{ assign 'forbiddenBtn' false}}
{{else}}
  {{assign 'productList' (product_mock_data section.settings.col section.settings.row)}}
  {{ assign 'forbiddenBtn' true}}
{{/if}}

{{!-- 计算product-item 宽度 参考snipper product-item-list --}}
{{assign 'real_product_img_width' (divide 1200 section.settings.col)}}
{{#if request.is_mobile}}
  {{assign 'real_product_img_width' 300}}
{{/if}}


<div class="{{#if section.settings.show_divider}}section--divider{{/if}} {{prefix}} {{prefix}}-{{section.id}}" data-slice_in_mobile="{{section.settings.slice_in_mobile}}">
    <div class='container g-4 g-md-6 {{prefix}}--container'>
        {{#if (boolean section.settings.title '||' section.settings.button_text)}}
            <h2 class="title4 col-24 align-top {{prefix}}--title">
                 <span class="{{prefix}}--title-content">
                    {{#isTruthy section.settings.title}}
                       {{section.settings.title}}
                    {{/isTruthy}}
                 </span>
                {{#if (isTruthy section.settings.button_text)}}
                    <span class='{{prefix}}--btn'>
                        <a class='btn btn-link'
                           href="/collections/{{#if (isTruthy categoryDetail.uniqueKey) }}{{categoryDetail.uniqueKey}}{{else}}{{categoryDetail.sortationId}}{{/if}}">
                            {{section.settings.button_text}}
                        </a>
                    </span>
                {{/if}}
            </h2>
        {{/if}}
      <div class='product-list-item-parent-controller g-4 row row-cols-2 row-cols-md-{{section.settings.col}} row-cols-lg-{{section.settings.col}} {{#if section.settings.slice_in_mobile}}{{prefix}}--scroll-container{{/if}} {{#if (boolean (boolean theme.settings.product_image_ratio '==' 0 ) '&&' section.settings.slice_in_mobile)}}{{prefix}}--ratio-free{{/if}}'>
        {{#each (sliceListByGrid productList section.settings.row section.settings.col)}}
          <div class='col{{#if ../forbiddenBtn}} {{../prefix}}--empty-product-item{{/if}}'>{{snippet 'product/commons/product-item' forbiddenBtn=../forbiddenBtn imgRealWidth=../real_product_img_width pcSize=(append '1/' ../section.settings.col) mSize="50vw" }} </div>
        {{/each}}
      </div>
    </div>
</div>

{{#schema}}
{
  "name": {
    "zh-hans-cn": "精选商品",
    "en": "Featured collection",
    "id": "Barang halus",
    "th": "สินค้าแนะนำ",
    "vi": "Hàng hóa nổi bật",
    "ms": "Produk pilihan khas",
    "zh-hant-tw": "精選商品"
  },
  "class": "index-section--gap",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": {
        "zh-hans-cn": "标题",
        "en": "Title",
        "id": "Judul",
        "th": "หัวข้อ",
        "vi": "Tiêu đề",
        "ms": "Tajuk",
        "zh-hant-tw": "標題"
      },
      "default": "Featured collection"
    },
    {
      "type": "collection_picker",
      "id": "product_categories",
      "label": {
        "zh-hans-cn": "商品分类",
        "en": "Collection list",
        "id": "Klasifikasi produk",
        "th": "หมวดหมู่",
        "vi": "Phân loại sản phẩm",
        "ms": "Produk kategori",
        "zh-hant-tw": "商品分類"
      }
    },
    {
      "type": "range",
      "id": "col",
      "label": {
        "zh-hans-cn": "列数",
        "en": "Number of columns",
        "id": "Jumlah kolom",
        "th": "จำนวนคอลัมน์",
        "vi": "Số cột",
        "ms": "Bilangan lajur",
        "zh-hant-tw": "列數"
      },
      "default": 5,
      "max": 5,
      "min": 1
    },
    {
      "type": "range",
      "id": "row",
      "label": {
        "zh-hans-cn": "行数",
        "en": "Number of rows",
        "id": "Jumlah baris",
        "th": "จำนวนแถว",
        "vi": "Số hàng",
        "ms": "Baris",
        "zh-hant-tw": "行數"
      },
      "default": 1,
      "max": 5,
      "min": 1
    },
    {
      "type": "switch",
      "id": "slice_in_mobile",
      "label": {
        "zh-hans-cn": "移动端左右滑动查看",
        "en": "Slide the screen left or right to view",
        "id": "Geser ke kiri dan kanan di port seluler untuk melihat",
        "th": "ปัดไปทางซ้ายและขวาบนมือถือเพื่อดู",
        "vi": "Lướt trái phạm trên mạng di động để xem",
        "ms": "Leret ke kiri dan kanan pada versi mudah alih untuk melihat",
        "zh-hant-tw": "移動端左右滑動查看"
      },
      "default": false
    },
    {
      "type": "text",
      "id": "button_text",
      "label": {
        "zh-hans-cn": "按钮文案",
        "en": "Button text",
        "id": "Tulisan tombol",
        "th": "ข้อความปุ่ม",
        "vi": "Nội dung nút",
        "ms": "Salinan butang",
        "zh-hant-tw": "按鈕文案"
      },
      "default": "View all"
    },
    {
      "type": "switch",
      "id": "show_divider",
      "label": {
        "zh-hans-cn": "展示分割线",
        "en": "Dismay the split line",
        "id": "Tampilkan garis pemisah",
        "th": "แสดงเส้นแบ่ง",
        "vi": "Thể hiện tuyến phân cách",
        "ms": "Tunjuk garis pemisah",
        "zh-hant-tw": "展示分割線"
      },
      "default": false
    }
  ],
  "presets": [
    {
      "name": {
        "zh-hans-cn": "精选商品",
        "en": "Featured collection",
        "id": "Barang halus",
        "th": "สินค้าแนะนำ",
        "vi": "Hàng hóa nổi bật",
        "ms": "Produk pilihan khas",
        "zh-hant-tw": "精選商品"
      },
      "category": {
        "zh-hans-cn": "商品",
        "en": "Product",
        "id": "Produk",
        "th": "สินค้า",
        "vi": "Sản phẩm",
        "ms": "Produk",
        "zh-hant-tw": "商品"
      }
    }
  ]
}
{{/schema}}