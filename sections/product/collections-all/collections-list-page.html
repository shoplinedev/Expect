
{{assign 'collection_order_ids' (product_blocks_order_translate section 'blocks' 'block_order')}}
{{assign 'collections-filter-all'  (JSONparse '[]')}}
{{array_map 'collections-all' sortations_page.data 'sortation' }}

{{#each collections-all}}
  {{assign 'productList' (get 'productList' (itemAt ../sortations_page.data @index))}}
{{/each}}

{{#if section.settings.display_type '===' 'designated'}}
  {{#each collection_order_ids}}
    {{#if (isTruthy (get settings.category_id ../all_collections )) }}
      {{array-push ../collections-filter-all (get settings.category_id ../all_collections)}}
    {{/if}}
  {{/each}}
{{/if}}

<div class="collection-list-main container g-4 g-md-6">
  {{#if section.settings.show_title}}
    <h1 class="collection-list-header title4">{{t 'collection.all.h1Title'}}</h1>
  {{/if}}
  {{snippet 'product/commons/collection-item-list' colNum=section.settings.col collectionData=(cond (is section.settings.display_type 'all') collections-all collections-filter-all)}}
</div>

{{#if (default ../request.uri.query.page_num sortations_page.pageNum)}} {{!-- 分类数量为零时，pageNum 为 null --}}
  {{#with sortations_page}}
    {{snippet
      'product/commons/pagination-slim'
      current=(default ../request.uri.query.page_num pageNum)
      enableNext=hasNext
      pageSize=(default ../request.uri.query.page_size pageSize)
      hidden=(or (boolean ../section.settings.display_type '!=' 'all') (and (is pageNum 1) (isFalsey hasNext)))
    }}
  {{/with}}
{{/if}}

{{#schema}}
{
  "name": {
    "zh-hans-cn": "分类列表",
    "en": "Collections list",
    "id": "Daftar Kategori",
    "th": "รายการหมวดหมู่",
    "vi": "Danh sách chuyên mục",
    "ms": "Senarai kategori",
    "zh-hant-tw": "分類列表"
  },
  "settings": [
    {
      "type": "select",
      "id": "display_type",
      "label": {
        "zh-hans-cn": "选择展示",
        "en": "Choose to display",
        "id": "Pilih untuk tampilkan",
        "th": "เลือกการแสดงผล",
        "vi": "Lựa chọn hiển thị",
        "ms": "Pilih paparan",
        "zh-hant-tw": "選擇展示"
      },
      "options": [
        {
          "value": "all",
          "label": {
            "zh-hans-cn": "全部商品分类",
            "en": "All product collections",
            "id": "Klasifikasi semua barang",
            "th": "หมวดหมู่สินค้าทั้งหมด",
            "vi": "Tất cả các loại hàng hóa",
            "ms": "Semua kategori produk",
            "zh-hant-tw": "全部商品分類"
          }
        },
        {
          "value": "designated",
          "label": {
            "zh-hans-cn": "指定商品分类",
            "en": "Assign a product collection",
            "id": "Menentukan kategori produk",
            "th": "หมวดหมู่สินค้าที่กำหนด",
            "vi": "Phân loại hàng hóa chỉ định",
            "ms": "Kategori produk yang ditentukan",
            "zh-hant-tw": "指定商品分類"
          }
        }
      ],
      "default": "all"
    },
    {
      "type": "switch",
      "id": "show_title",
      "label": {
        "zh-hans-cn": "展示页面标题",
        "en": "Display the page title",
        "id": "Tampilkan judul halaman",
        "th": "หัวข้อหน้าที่แสดง",
        "vi": "Hiển thị tiêu đề trang",
        "ms": "Paparkan tajuk halaman",
        "zh-hant-tw": "展示頁面標題"
      },
      "default": true
    },
    {
      "type": "range",
      "id": "col",
      "label": {
        "zh-hans-cn": "列数",
        "en": "Number of columns",
        "id": "Jumlah kolom",
        "th": "จำนวนคอลัมน์",
        "vi": "Số cột",
        "ms": "Bilangan lajur",
        "zh-hant-tw": "列數"
      },
      "min": 2,
      "max": 5,
      "unit": {
        "zh-hans-cn": "列",
        "en": "column",
        "id": "",
        "th": "",
        "vi": "",
        "ms": "",
        "zh-hant-tw": ""
      },
      "default": 5
    }
  ],
  "block_info": {
    "zh-hans-cn": "设置中展示指定商品分类时选择才生效",
    "en": "Selected option will be effective only when you choose to display assigned product collections in Setting",
    "id": "Pengaturan ini berlaku hanya jika dipilih saat menentukan klasifikasi produk",
    "th": "การเลือกจะมีผลก็ต่อเมื่อหมวดหมู่สินค้าที่ระบุแสดงในการตั้งค่า",
    "vi": "Phải chọn trong mục cài đặt hiển thị phân loại sản phẩm chỉ định thì mới hiển thị được",
    "ms": "Pemilihan hanya berkuat kuasa apabila kategori produk yang ditentukan dipaparkan dalam tetapan",
    "zh-hant-tw": "設置中展示指定商品分類時選擇才生效"
  },
  "blocks": [
    {
      "type": "collection",
      "icon": "productCategories",
      "name": {
        "zh-hans-cn": "分类",
        "en": "Collection",
        "id": "Buat kategori",
        "th": "หมวดหมู่",
        "vi": "Phân loại",
        "ms": "Kategori",
        "zh-hant-tw": "分類"
      },
      "settings": [
        {
          "type": "collection_picker",
          "id": "category_id",
          "label": {
            "zh-hans-cn": "商品分类",
            "en": "Collection list",
            "id": "Klasifikasi produk",
            "th": "หมวดหมู่",
            "vi": "Phân loại sản phẩm",
            "ms": "Produk kategori",
            "zh-hant-tw": "商品分類"
          }
        }
      ]
    }
  ],
  "default": {
    "settings": {
      "display_type": "all",
      "show_title": true,
      "col": 5
    }
  }
}
{{/schema}}
