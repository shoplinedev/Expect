{{ assign 'ratio_class' '' }}
{{#if section.settings.ratio '===' '16:9' }}
{{ assign 'ratio_class' 'video--r16-9' }}
{{/if}}

{{#if section.settings.ratio '===' '21:9' }}
{{ assign 'ratio_class' 'video--r21-9' }}
{{/if}}

<div class="container g-4 g-md-6">
  {{#if section.settings.title}}
    <h2 class="video__title title4 section-title">{{ section.settings.title }}</h2>
  {{/if}}

  {{#style}}
    {{ assign 'background_position' (join (split section.settings.background_position '-') ' ') }}
    .video--{{ section.id }} .video__cover {
      background-position: {{ background_position }};
    }
  {{/style}}
  <div
    class="video video--{{ section.id }} {{ ratio_class }}"
    data-id="{{ section.id }}"
    data-section-id="{{ section.id }}"
    data-section-type="video"
  >
    <script type="text/json" id="Video-data-{{ section.id }}">{{{ stringify section.settings }}}</script>
    {{#unless section.settings.autoplay}}
      {{#if (boolean section.settings.cover.url)}}
        <div class="video__cover lozad" data-background-image="{{ img_url section.settings.cover.url width=2000 }}">

          <div class="video-overlay" style="{{ overlay_background }}">
            {{#if section.settings.url}}
              <div class="video-overlay__button" data-controls="Video-{{ section.id }}">
                {{snippet 'icons/icon_video_play'}}
              </div>
            {{/if}}
          </div>
        </div>
      {{/if}}
    {{/unless}}
    <div class="video__controll">
      {{#contains section.settings.url 'youtube.com/watch'}}

        {{ assign 'video_id' (split section.settings.url 'v=') }}
        {{ assign 'video_id' (first (split (itemAt video_id 1) '&')) }}

        <div
          class="video-data"
          id="Video-{{ section.id }}"
          data-video-id="{{ video_id }}"
          data-type="youtube"
          data-url="{{ section.settings.url }}"
          data-autoplay="{{ section.settings.autoplay }}"
          data-slient="{{ section.settings.slient }}"
          data-aspect-ratio="{{ section.settings.ratio }}"
        >
        </div>
      {{else}}
        {{#contains section.settings.url 'vimeo.com'}}
          {{ assign 'video_id' (split section.settings.url '.com/') }}
          {{ assign 'video_id' (itemAt video_id 1) }}
          <div
            class="video-data is-vimeo"
            id="Video-{{ section.id }}"
            data-video-id="{{ video_id }}"
            data-type="vimeo"
            data-url="{{ section.settings.url }}"
            data-autoplay="{{ section.settings.autoplay }}"
            data-slient="{{ section.settings.slient }}"
            data-aspect-ratio="{{ section.settings.ratio }}"
          >
          </div>
        {{else}}
          {{ snippet 'icons/icon_video_placeholder' }}
        {{/contains}}
      {{/contains}}
    </div>
  </div>
  {{#if section.settings.caption}}
    <div class="video__caption">
      <div class="body3 sl-richtext">
        {{{ section.settings.caption }}}
      </div>
    </div>
  {{/if}}
</div>

{{#schema}}
{
	"name": {
		"zh-hans-cn": "视频",
		"en": "Video"
	},
  "icon": "video",
  "class": "index-section--video index-section--gap",
	"settings": [{
			"type": "text",
			"id": "title",
			"label": {
				"zh-hans-cn": "标题",
				"en": "Title"
			},
			"default": "Video"
		},
		{
			"type": "text",
			"id": "url",
      "format": "video",
      "placeholder": "https://www.youtube.com/watch?v=V7BEzkRBp_g",
			"info": {
				"zh-hans-cn": "输入YouTube或Vimeo嵌入链接",
				"en": "Enter the embedded link of YouTube or Vimeo"
			},
			"label": {
				"zh-hans-cn": "视频链接",
				"en": "Video link"
			}
		},
		{
			"type": "richtext",
			"id": "caption",
			"label": {
				"zh-hans-cn": "描述",
				"en": "Description"
			}
		},
		{
			"type": "switch",
			"id": "autoplay",
      "info": {
				"zh-hans-cn": "自动播放时，视频会默认调至静音",
				"en": "The video will be muted by default when the autoplay is activated"
      },
			"label": {
				"zh-hans-cn": "自动播放视频",
				"en": "Video autoplay"
			},
			"default": false
		},
		{
			"type": "select",
			"id": "ratio",
			"label": {
				"zh-hans-cn": "视频长宽比",
				"en": "Video length-width ratio"
			},
			"default": "16:9",
			"options": [{
					"label": "16:9",
					"value": "16:9"
				},
				{
					"label": "21:9",
					"value": "21:9"
				}
			]
		},
		{
			"type": "image_picker",
			"id": "cover",
			"label": {
				"zh-hans-cn": "封面图",
				"en": "Cover image"
			}
		},
		{
			"type": "select",
			"id": "background_position",
			"label": {
				"zh-hans-cn": "封面图展示区域",
				"en": "Display area of cover image"
			},
			"default": "center",
			"options": [{
					"value": "left-top",
					"label": {
						"zh-hans-cn": "左上方",
						"en": "Upper left"
					}
				},
				{
					"value": "top",
					"label": {
						"zh-hans-cn": "正上方",
						"en": "Right above"
					}
				},
				{
					"value": "right-top",
					"label": {
						"zh-hans-cn": "右上方",
						"en": "Upper right"
					}
				},
				{
					"value": "left",
					"label": {
						"zh-hans-cn": "左侧",
						"en": "Left side"
					}
				},
				{
					"value": "center",
					"label": {
						"zh-hans-cn": "正中",
						"en": "Center"
					}
				},
				{
					"value": "right",
					"label": {
						"zh-hans-cn": "右侧",
						"en": "Right side"
					}
				},
				{
					"value": "left-bottom",
					"label": {
						"zh-hans-cn": "左下方",
						"en": "Bottom left"
					}
				},
				{
					"value": "bottom",
					"label": {
						"zh-hans-cn": "正下方",
						"en": "Below"
					}
				},
				{
					"value": "right-bottom",
					"label": {
						"zh-hans-cn": "右下方",
						"en": "Bottom right"
					}
				}
			]
		}
	],
	"presets": [{
		"name": {
			"zh-hans-cn": "视频",
			"en": "Video"
		},
    "icon": "video",
    "category":{
      "zh-hans-cn":"内容展示",
      "en": "Content display"
    },
    "settings": {
      "title": "Video",
      "autoplay": false,
      "ratio": "16:9",
      "background_position": "center",
      "overlay": false,
      "overlay_color": "#000000",
      "overlay_transparent": 50,
      "cover": {
        "url": ""
      },
      "caption": "A short description of the video."
    }
	}]
}
{{/schema}}


