{{assign 'limit' force_limit}}
{{assign 'startAt' offset}}
{{#if (isFalsey force_limit)}}
	{{assign 'limit' (length main_menu.nodeTree)}}
{{/if}}
{{#if (isFalsey startAt)}}
	{{assign 'startAt' 0}}
{{/if}}
<ul class="desktop-site-nav" data-main-menu-link-list="{{section.settings.main_menu_link_list}}">
	{{#with this as |global|}}
		{{#each main_menu.nodeTree}}
			{{assign 'has_dropdown' false}}
			{{assign 'is_megamenu' false}}

			{{#if @index '>=' global.startAt}}
				{{#if @index '<' (plus global.limit global.startAt)}}
					{{#if (isTruthy (length this.childNodes))}}
						{{assign 'has_dropdown' true}}
						{{#if (depth_of_nav this) '>' 1}}
							{{assign 'is_megamenu' true}}
						{{/if}}
					{{/if}}

					<li data-site-nav-menu-id="{{this.id}}" class="d-site--nav__item {{#if (boolean global.mega_menu_images '&&' is_megamenu)}}site-nav__item-link{{/if}} {{#if has_dropdown}}site-nav--has-dropdown{{/if}} {{#if is_megamenu}}site-nav--is-megamenu{{/if}}">
						{{assign 'navItem' (navLink this global.request.uri.query global.request.locale)}}
						<a class="navigation-font navigation-font-size site-nav__link d-site--nav__underline navigation-font-size  {{#if has_dropdown}}site-nav__link--has-dropdown{{/if}} {{#if global.theme.settings.type_navigation_uppercase}}text-uppercase{{/if}}"
						{{{navItem.hrefAttr}}}>
							{{navItem.name}}
						</a>
						{{#if is_megamenu}}

              {{!-- 是否需要展示分类下的商品 --}}
              {{assign 'show_sortation_product' (boolean global.mega_menu_images)}}

							<div class="site-nav__dropdown megamenu text-left">
								<div class="container magamenu__container g-4 g-md-6">
									<div class="grid {{#if show_sortation_product}}grid-4{{/if}}">
                    {{#each this.childNodes}}
                      <div class="grid__item">
                        {{assign 'navItem' (navLink this global.request.uri.query global.request.locale)}}
                        <div class="body3 fw-blod">
                          <a data-li-id="{{../id}}" {{{navItem.hrefAttr}}} data-node-type="{{this.nodeType}}" data-sortation-id="{{this.pageLink}}" class="{{#if (boolean global.mega_menu_images)}}site-nav__sortation-link{{/if}} site-nav__dropdown-link site-nav__node site-nav__dropdown-link--top-level">{{ navItem.name }}</a>
                        </div>
                        {{#each this.childNodes}}
                          {{assign 'navItem' (navLink this global.request.uri.query global.request.locale)}}
                            <div>
                              <a data-li-id="{{../../id}}" data-node-type="{{this.nodeType}}" data-sortation-id="{{this.pageLink}}" class="{{#if (boolean global.mega_menu_images)}}site-nav__sortation-link{{/if}} site-nav__dropdown-link site-nav__node body5" {{{navItem.hrefAttr}}}>{{navItem.name}}</a>
                            </div>
                        {{/each}}
                      </div>
                    {{/each}}
                  </div>
                  {{!-- 展示商品信息 --}}
                  <div class="nav__product--container {{#if show_sortation_product}}nav__product--container--display{{/if}}"></div>
								</div>
							</div>
						{{/if}}


						{{#unless is_megamenu}}
							{{#if has_dropdown}}
              <div class="site-nav__dropdown unmegamenu-container">
                <ul class="text-left">
                  {{#each this.childNodes}}
                    <li class="{{#if has_sub_dropdown}}site-nav__deep-dropdown-trigger{{/if}}">
                      {{assign 'navItem' (navLink this global.request.uri.query global.request.locale)}}
                      <a {{{navItem.hrefAttr}}} class="body5 site-nav__dropdown-link site-nav__dropdown-link--second-level">
                        {{navItem.name}}
                      </a>
                    </li>
                  {{/each}}
                </ul>
              </div>
							{{/if}}
						{{/unless}}
					</li>
				{{/if}}
			{{/if}}
		{{/each}}
	{{/with}}

</ul>
